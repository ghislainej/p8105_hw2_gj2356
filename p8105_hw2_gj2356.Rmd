---
title: "p8105_hw2_gj2356"
author: "Ghislaine Jumonville"
date: "2023-09-27"
output: github_document
---

```{r, echo = FALSE}
library(tidyverse)
```


## PROBLEM 1

Cleaning the dataset `pols-month.csv` in the code chunk below. In the new dataframe `pols_month_df`, the variable `mon` is separated into `year`, `month`, and `day`. There is a new variable `president` that takes on the values `dem` if `prez_dem = 1` or `gop` if `prez_gop = 1`. The variables `prez_dem`, `prez_gop`, and `date` are removed from the final data frame.

```{r}
pols_month_df = read_csv("./fivethirtyeight_datasets/pols-month.csv") |>
                separate(mon, into = c("year", "month", "day"), sep = "-") |> 
                mutate(
                  month = 
                          case_match(
                            month,
                            "01" ~ "Jan",
                            "02" ~ "Feb",
                            "03" ~ "Mar",
                            "04" ~ "Apr",
                            "05" ~ "May",
                            "06" ~ "Jun",
                            "07" ~ "Jul",
                            "08" ~ "Aug",
                            "09" ~ "Sep",
                            "10" ~ "Oct",
                            "11" ~ "Nov",
                            "12" ~ "Dec"),
                  month = as.factor(month)) |> 
                mutate(
                  president = case_when( prez_gop == 1 ~ "gop", 
                                              prez_gop == 0 ~ "dem" )) |> 
              select(-prez_dem, -prez_gop, -day)
```


Cleaning the next dataset `snp.csv` in the code chunk below. The resulting data frame `snp_df` has the `date` split into `month`and `year` with `day` removed. The months have been translated from numbers to their names. I have added either `20` or `19` to the beginning of the years so that they have four characters.

```{r}
snp_df = read_csv("./fivethirtyeight_datasets/snp.csv") |> 
        separate(date, into = c("month", "day", "year"), sep = "/") |> 
        select(year, month, close) |> 
        mutate(
            month = 
                  case_match(
                    month,
                      "1" ~ "Jan",
                      "2" ~ "Feb",
                      "3" ~ "Mar",
                      "4" ~ "Apr",
                      "5" ~ "May",
                      "6" ~ "Jun",
                      "7" ~ "Jul",
                      "8" ~ "Aug",
                      "9" ~ "Sep",
                      "10" ~ "Oct",
                      "11" ~ "Nov",
                      "12" ~ "Dec"),
            month = as.factor(month)) |> 
        mutate(
          year = 
            case_when(
              year < 16 ~ paste0("20", year),
              year >= 16 ~ paste0("19", year))
            )
```

Cleaning the last dataset `unemployment.csv` in the code chunk below. Here I used `pivot_longer` to transform the existing data frame to have more rows and less columns by making two new variables `month` and `percent_unemployment`. I also had to rename `Year` to `year` and make it a character variable type instead of numeric for joining purposes.

```{r}
unemployment_df = read_csv("./fivethirtyeight_datasets/unemployment.csv") |> 
                  pivot_longer(
                      Jan:Dec,
                      names_to = "month",
                      values_to = "percent_unemployment") |> 
                  rename(year = Year) |> 
                  mutate(year = as.character(year))
```

Here I used `left_join` to join `snp_df` into `pols_month_df` by `year` and `month` to create `snp_pols_df`. Then I repeated the process joining `unemployment_df` into `snp_pols_df` to create the final data frame `hw2_joined_df`.

```{r}
snp_pols_df = left_join(pols_month_df, snp_df, by = c("year","month"))
hw2_joined_df = left_join(snp_pols_df, unemployment_df, by = c("year","month"))
```

