---
title: "p8105_hw2_gj2356"
author: "Ghislaine Jumonville"
date: "2023-09-27"
output: github_document
---

```{r, echo = FALSE}
library(tidyverse)
```


## PROBLEM 1

Cleaning the dataset `pols-month.csv` in the code chunk below. In the new dataframe `pols_month_df`, the variable `mon` is separated into `year`, `month`, and `day`. There is a new variable `president` that takes on the values `dem` if `prez_dem = 1` or `gop` if `prez_gop = 1`. The variables `prez_dem`, `prez_gop`, and `date` are removed from the final data frame.

```{r}
pols_month_df = read_csv("./fivethirtyeight_datasets/pols-month.csv") |>
                separate(mon, into = c("year", "month", "day"), sep = "-") |> 
                mutate(
                  month = 
                          case_match(
                            month,
                            "01" ~ "Jan",
                            "02" ~ "Feb",
                            "03" ~ "Mar",
                            "04" ~ "Apr",
                            "05" ~ "May",
                            "06" ~ "Jun",
                            "07" ~ "Jul",
                            "08" ~ "Aug",
                            "09" ~ "Sep",
                            "10" ~ "Oct",
                            "11" ~ "Nov",
                            "12" ~ "Dec"),
                  month = as.factor(month)) |> 
                mutate(
                  president = case_when( prez_gop == 1 ~ "gop", 
                                              prez_gop == 0 ~ "dem" )) |> 
              select(-prez_dem, -prez_gop, -day)
```


Cleaning the next dataset `snp.csv` in the code chunk below. The resulting data frame `snp_df` has the `date` split into `month`and `year` with `day` removed. The months have been translated from numbers to their names. I have added either `20` or `19` to the beginning of the years so that they have four characters.

```{r}
snp_df = read_csv("./fivethirtyeight_datasets/snp.csv") |> 
        separate(date, into = c("month", "day", "year"), sep = "/") |> 
        select(year, month, close) |> 
        mutate(
            month = 
                  case_match(
                    month,
                      "1" ~ "Jan",
                      "2" ~ "Feb",
                      "3" ~ "Mar",
                      "4" ~ "Apr",
                      "5" ~ "May",
                      "6" ~ "Jun",
                      "7" ~ "Jul",
                      "8" ~ "Aug",
                      "9" ~ "Sep",
                      "10" ~ "Oct",
                      "11" ~ "Nov",
                      "12" ~ "Dec"),
            month = as.factor(month)) |> 
        mutate(
          year = 
            case_when(
              year < 16 ~ paste0("20", year),
              year >= 16 ~ paste0("19", year))
            )
```

Cleaning the last dataset `unemployment.csv` in the code chunk below. Here I used `pivot_longer` to transform the existing data frame to have more rows and less columns by making two new variables `month` and `percent_unemployment`. I also had to rename `Year` to `year` and make it a character variable type instead of numeric for joining purposes.

```{r}
unemployment_df = read_csv("./fivethirtyeight_datasets/unemployment.csv") |> 
                  pivot_longer(
                      Jan:Dec,
                      names_to = "month",
                      values_to = "percent_unemployment") |> 
                  rename(year = Year) |> 
                  mutate(year = as.character(year))
```

Here I used `left_join` to join `snp_df` into `pols_month_df` by `year` and `month` to create `snp_pols_df`. Then I repeated the process joining `unemployment_df` into `snp_pols_df` to create the final data frame `hw2_joined_df`.

```{r}
snp_pols_df = left_join(pols_month_df, snp_df, by = c("year","month"))
hw2_joined_df = left_join(snp_pols_df, unemployment_df, by = c("year","month"))
```

The first dataset `pols_month_df` contained 822 observations and 9 variables that had information on US politicians and their political affiliations at different times, ranging from 1947 to 2015. The next dataset `snp_df` contained 787 observations and 2 variables that showed the Standard & Poor's stock market index (S&P) and the corresponding date with years ranging from 1950 to 2015. The last dataset `unemployment_df` contained 68 observations and 13 variables before it was transformed. There was information about the percentage of unemployment for each month and year, ranging from 1948 to 2015.

The final and resulting dataset from joining the 3 aforementioned datasets together, `hw2_joined_df`, has 822 observations and 11 variables. The range of `year` is from 1947 to 2015. There is information on the political affiliation of the president (`president`) for any given year along with the number of national politicians that are either democratic or republican. There is also information on the S&P at the time (`close`) along with unemployment percentages (`percent_unemployment`).


## PROBLEM 2

Mr. Trash Wheel
```{r}
library(readxl)
mr_trash_df = 
  read_excel("./202207 Trash Wheel Collection Data.xlsx", 
             sheet = "Mr. Trash Wheel", 
             range = "A2:N549", 
             col_names = TRUE) |> 
  janitor::clean_names() |> 
  select(-year) |> 
  separate(date, into = c("year", "month_num", "day"), sep = "-") |> 
  select(dumpster, year, month, day, everything(), -month_num) |> 
  mutate(
    homes_powered = ((weight_tons*500)/30),
    trash_wheel = "Mr"
  )
head(mr_trash_df)
```

Professor Trash Wheel
```{r}
prof_trash_df =
  read_excel("./202207 Trash Wheel Collection Data.xlsx", 
             sheet = "Professor Trash Wheel", 
             range = "A2:M96", 
             col_names = TRUE) |> 
  janitor::clean_names() |> 
  select(-year) |> 
  separate(date, into = c("year", "month_num", "day"), sep = "-") |> 
  select(dumpster, year, month, day, everything(), -month_num) |> 
  mutate(
    homes_powered = ((weight_tons*500)/30),
    trash_wheel = "Professor"
  )
head(prof_trash_df)
```

Gwynnda Trash Wheel
```{r}
gwynnda_trash_df =
  read_excel("./202207 Trash Wheel Collection Data.xlsx", 
             sheet = "Gwynnda Trash Wheel", 
             range = "A2:K108", 
             col_names = TRUE) |> 
  janitor::clean_names() |> 
  select(-year) |> 
  separate(date, into = c("year", "month_num", "day"), sep = "-") |> 
  select(dumpster, year, month, day, everything(), -month_num) |> 
  mutate(
    homes_powered = ((weight_tons*500)/30),
    trash_wheel = "Gwynnda"
  )
head(gwynnda_trash_df)
```

Join
```{r}
trash_tidy =
  bind_rows(mr_trash_df, prof_trash_df, gwynnda_trash_df) |> 
  select(trash_wheel, everything())
```

Description
```{r}
sum(select(
  trash_tidy(where)
))
```

